<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roleta - Eureka do Padre</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/roleta.css') }}">
</head>
<body>
    <div class="roleta-layout">
        <!-- Placar √† esquerda -->
        <aside class="placar-col">
            <div class="placar-header">
                <h2>üèÜ Placar</h2>
                <div id="placar" class="placar-grid"></div>
                <div class="placar-botoes">
                    <a href="/relatorio" class="btn-relatorio">üìä Relat√≥rio</a>
                    <a href="/novo_jogo" class="btn-novo-jogo">üîÑ Novo Jogo</a>
                </div>
            </div>
        </aside>
        <!-- Box cinza central -->
        <main class="roleta-col">
            <div class="box-cinza-central" style="width: 320px; height: 320px; background: #e0e0e0; border-radius: 24px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: #888;">
                √Årea da Roleta
            </div>
        </main>
        <!-- Tema sorteado √† direita -->
        <aside class="tema-col">
            <div class="tema-sorteado-box">
                <h2>Tema Sorteado</h2>
                <div id="tema-sorteado" class="tema-sorteado">Nenhum</div>
                <button id="btnIrPergunta" class="btn-primary" disabled>IR PARA PERGUNTA</button>
            </div>
        </aside>
    </div>
    <script>
    // Fun√ß√£o para atualizar o placar dinamicamente
    function atualizarPlacar(equipes) {
        const placarDiv = document.getElementById('placar');
        placarDiv.innerHTML = '';
        equipes.forEach(eq => {
            // Corrige nome da cor para classe CSS: min√∫sculo e espa√ßos/acentos para underline
            let corClasse = eq.cor.toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu, '').replace(/\s+/g, '_');
            const el = document.createElement('div');
            el.className = `equipe-placar cor-${corClasse}`;
            el.innerHTML = `<span class='equipe-nome'>${eq.nome}</span><span class='equipe-pontos'>${eq.pontos}</span>`;
            placarDiv.appendChild(el);
        });
    }

    // Carregar equipes reais do backend (GET)
    fetch('/api/estado_jogo')
        .then(response => response.json())
        .then(data => {
            if (data.equipes && data.equipes.length > 0) {
                atualizarPlacar(data.equipes);
            } else {
                // fallback: mostra exemplo
                atualizarPlacar([
                    {nome: 'Equipe Azul', cor: 'azul', pontos: 0},
                    {nome: 'Equipe Laranja', cor: 'laranja', pontos: 0}
                ]);
            }
        })
        .catch(() => {
            atualizarPlacar([
                {nome: 'Equipe Azul', cor: 'azul', pontos: 0},
                {nome: 'Equipe Laranja', cor: 'laranja', pontos: 0}
            ]);
        });
    </script>
